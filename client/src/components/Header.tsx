import React from 'react'
import { Link, useLocation, useNavigate } from 'react-router-dom'

import { logout } from '../redux/slices/authSlice'
import { useAppDispatch } from '../redux/store'

const navigation = [
   { name: "home", link: '/' },
   { name: "my posts", link: '/posts' },
   { name: "create post", link: '/add-post' }
]

const Header: React.FC = () => {

   const dispatch = useAppDispatch()
   const { pathname } = useLocation()
   const navigate = useNavigate()

   const [menu, setMenu] = React.useState<boolean>(false)
   menu && window.innerWidth < 767.98 ? document.body.classList.add('lock') : document.body.classList.remove('lock')

   const handleLogout = () => {
      dispatch(logout())
      window.localStorage.removeItem('token')
      navigate('/login')
   }

   return (
      <>
         {
            pathname !== '/login' && pathname !== '/register' &&
            <header className='header'>
               <div className="container">
                  <div className="header__body">

                     <div className="header__column">
                        <Link to='/' className='header__logo'>
                           <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="100" height="55" viewBox='0 0 100 55'><path fill="#" d="M1.55029296875,18.03955078125q-0.06103515625-0.74462890625,0.09765625-1.2939453125t0.634765625-0.9033203125t1.52587890625-0.35400390625l3.9306640625,0q0.8056640625,0,2.11181640625,0.08544921875t2.8076171875,0.25634765625t2.99072265625,0.52490234375t2.72216796875,0.87890625t2.001953125,1.2939453125t0.76904296875,1.81884765625q0,1.4892578125-0.86669921875,2.79541015625t-2.1728515625,2.35595703125t-2.7587890625,1.86767578125t-2.60009765625,1.47705078125q4.541015625,1.0009765625,7.1044921875,4.150390625t2.5634765625,7.861328125q0,2.490234375-0.9521484375,4.91943359375t-2.60009765625,4.38232421875t-3.90625,3.1494140625t-4.84619140625,1.1962890625q-0.341796875,0-0.76904296875-0.0732421875t-0.78125-0.23193359375t-0.6103515625-0.45166015625t-0.25634765625-0.7568359375q0-2.1484375,2.3193359375-2.1484375q0.390625,0,0.91552734375,0.10986328125t0.81787109375,0.45166015625q1.3427734375-0.5615234375,2.45361328125-1.7822265625t1.8798828125-2.72216796875t1.1962890625-3.1494140625t0.42724609375-2.99072265625q0-1.611328125-0.47607421875-3.28369140625t-1.37939453125-3.1005859375t-2.2216796875-2.40478515625t-3.02734375-1.220703125q-0.439453125-0.048828125-0.96435546875-0.0732421875l-1.0498046875-0.048828125t-1.025390625-0.146484375t-0.86669921875-0.390625q0.1953125,4.052734375,0.50048828125,8.0810546875t0.81787109375,8.0810546875q0.1953125,0.1953125,0.2685546875,0.57373046875t0.1220703125,0.8056640625t0.048828125,0.81787109375l0,0.6591796875q0,0.439453125-0.29296875,0.72021484375t-0.69580078125,0.45166015625t-0.8544921875,0.2197265625t-0.79345703125,0.048828125q-1.0986328125,0-1.6845703125-0.29296875t-0.830078125-0.8544921875t-0.3173828125-1.28173828125t-0.1220703125-1.57470703125q-0.6591796875-6.8115234375-0.9521484375-13.4765625t-0.29296875-13.4765625q0-0.8056640625-0.06103515625-1.55029296875z M6.0546875,17.001953125q0,3.0029296875,0.1953125,6.01806640625t0.341796875,6.01806640625q1.0986328125-0.6591796875,2.880859375-1.55029296875t3.45458984375-1.96533203125t2.86865234375-2.3681640625t1.1962890625-2.8076171875q0-1.1962890625-1.416015625-1.81884765625t-3.2958984375-0.927734375t-3.67431640625-0.37841796875t-2.55126953125-0.2197265625z M27.433349609375,39.951171875l0-3.857421875q0-4.00390625,0.13427734375-7.94677734375t0.23193359375-7.94677734375q0-0.7568359375-0.048828125-1.6845703125q-0.0244140625-0.2685546875-0.0244140625-0.5126953125q0-0.6103515625,0.09765625-1.1962890625q0.1220703125-0.78125,0.59814453125-1.3427734375t1.57470703125-0.5615234375q0.9033203125,0,1.37939453125,0.1953125t0.67138671875,0.57373046875t0.2197265625,0.9521484375t0.0244140625,1.33056640625q0,4.052734375-0.09765625,8.1298828125q-0.0732421875,2.7099609375-0.0732421875,5.419921875q0,1.3671875,0.0244140625,2.734375q0.048828125,4.052734375,0.37841796875,8.10546875t1.11083984375,8.0078125q2.44140625-0.09765625,4.8828125-0.244140625t4.8828125-0.146484375q0.244140625,0,0.69580078125,0.048828125t0.9033203125,0.1708984375t0.76904296875,0.3173828125t0.3173828125,0.5615234375q0,0.244140625-0.2197265625,0.4150390625t-0.4150390625,0.2685546875l-0.048828125,0q-0.390625,0.1953125-1.55029296875,0.37841796875t-2.63671875,0.28076171875t-3.1005859375,0.1708984375t-3.0517578125,0.1220703125t-2.47802734375,0.0732421875t-1.2939453125,0.0244140625l-0.2197265625,0q-0.5859375,0-1.318359375-0.1953125q-0.87890625-0.244140625-1.0986328125-0.9521484375q-0.439453125-1.806640625-0.69580078125-3.74755859375t-0.390625-3.94287109375t-0.13427734375-4.00390625z M49.59326171875,35.2392578125q0-1.4404296875,0.15869140625-3.4912109375t0.5859375-4.2724609375t1.1474609375-4.4189453125t1.84326171875-3.8818359375t2.685546875-2.6611328125q1.2939453125-0.8056640625,2.978515625-0.8056640625q0.341796875,0,0.7080078125,0.048828125q4.248046875,0.390625,6.53076171875,1.94091796875t3.33251953125,3.9306640625t1.220703125,5.419921875t0.1708984375,6.40869140625q0,2.7099609375-0.50048828125,5.89599609375t-1.77001953125,5.94482421875t-3.50341796875,4.60205078125t-5.67626953125,1.84326171875q-2.099609375,0-3.67431640625-0.76904296875t-2.67333984375-2.05078125t-1.806640625-2.978515625t-1.07421875-3.515625t-0.52490234375-3.67431640625t-0.15869140625-3.515625z M54.54931640625,34.140625q0,1.0498046875,0.0244140625,2.57568359375t0.20751953125,3.21044921875t0.47607421875,3.35693359375t0.86669921875,3.03955078125t1.45263671875,2.24609375t2.1240234375,0.927734375l0.1220703125,0q1.123046875,0,2.001953125-0.8544921875q0.927734375-0.9033203125,1.64794921875-2.1728515625t1.2451171875-2.67333984375t0.93994140625-2.40478515625l-0.09765625,0.2197265625q0.7080078125-2.24609375,0.9521484375-4.60205078125t0.244140625-4.65087890625q0-1.0986328125-0.146484375-2.64892578125t-0.47607421875-3.23486328125t-0.8544921875-3.33251953125t-1.33056640625-2.86865234375t-1.8798828125-1.85546875q-0.78125-0.4638671875-1.7333984375-0.48828125q-0.3662109375,0-0.732421875,0.0732421875q-1.2451171875,0.244140625-2.1240234375,1.220703125t-1.42822265625,2.40478515625t-0.84228515625,3.125t-0.45166015625,3.41796875t-0.18310546875,3.2958984375t-0.0244140625,2.67333984375z M65.56005859375,41.66015625l0-0.048828125l0,0.048828125z M76.050048828125,31.69921875q0-1.611328125,0.13427734375-3.52783203125t0.47607421875-3.84521484375t1.025390625-3.72314453125t1.7578125-3.1982421875t2.62451171875-2.23388671875t3.69873046875-0.830078125q1.708984375,0,3.1494140625,0.6591796875t2.5146484375,1.7822265625t1.67236328125,2.62451171875t0.59814453125,3.13720703125q0,0.439453125-0.59814453125,0.54931640625t-0.84228515625,0.10986328125q-0.439453125,0-0.84228515625-0.0732421875t-0.59814453125-0.5859375q-0.341796875-0.9521484375-0.72021484375-2.001953125t-0.927734375-1.91650390625t-1.35498046875-1.42822265625q-0.732421875-0.48828125-1.85546875-0.48828125l-0.1953125,0q-2.05078125,0.048828125-3.0517578125,1.46484375t-1.37939453125,3.4423828125t-0.37841796875,4.296875l0,4.0283203125q0,1.0009765625,0.0732421875,2.9052734375t0.35400390625,4.150390625t0.732421875,4.57763671875t1.220703125,4.248046875t1.84326171875,3.125t2.587890625,1.20849609375q1.3427734375,0,2.34375-0.927734375t1.72119140625-2.38037109375t1.220703125-3.2470703125t0.830078125-3.60107421875t0.50048828125-3.35693359375t0.2685546875-2.55126953125q-0.2685546875-0.0244140625-0.5126953125-0.0244140625q-1.1474609375,0-2.24609375,0.3662109375q-1.3916015625,0.4150390625-2.783203125,0.4150390625q-0.1953125,0-0.52490234375-0.0244140625t-0.62255859375-0.1220703125t-0.52490234375-0.28076171875t-0.23193359375-0.47607421875q0-0.5615234375,1.23291015625-0.9521484375t2.8076171875-0.67138671875t3.03955078125-0.40283203125t1.9287109375-0.1220703125q0.244140625,0,0.69580078125,0.048828125t0.9033203125,0.1708984375t0.76904296875,0.35400390625t0.3173828125,0.57373046875q0,0.29296875-0.2197265625,0.52490234375t-0.54931640625,0.35400390625t-0.67138671875,0.1708984375t-0.537109375,0.048828125q0.0244140625,0.5615234375,0.0244140625,1.1474609375q0,1.318359375-0.0732421875,2.8076171875q-0.1220703125,2.1484375-0.48828125,4.296875t-1.123046875,4.1748046875t-1.9287109375,3.57666015625t-2.89306640625,2.50244140625t-4.08935546875,0.9521484375q-2.587890625,0-4.3701171875-1.0986328125t-2.9052734375-2.9296875t-1.74560546875-4.150390625t-0.89111328125-4.74853515625t-0.32958984375-4.72412109375t-0.06103515625-4.150390625z" /></svg>
                        </Link>
                     </div>

                     <div className="header__column">

                        <div onClick={() => setMenu(!menu)} className={`menu__icon icon-menu ${menu ? 'active' : ''}`}>
                           <span></span>
                           <span></span>
                           <span></span>
                        </div>

                        <nav className={`menu__body ${menu ? 'active' : ''}`}>
                           <ul className="menu__list">
                              {navigation.map((obj) => <li onClick={() => setMenu(false)} key={obj.name}><Link to={obj.link} className={`menu__link ${pathname === obj.link ? 'active' : ''}`}><span>{obj.name}</span></Link></li>)}
                           </ul>
                        </nav>

                     </div>

                     <div className="header__column">
                        <div className="header__buttons">
                           <label className="header__switch">
                              <input onClick={() => document.body.classList.toggle('dark')} type="checkbox" />
                              <span>
                                 <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path d="M10.719 2.082c-2.572 2.028-4.719 5.212-4.719 9.918 0 4.569 1.938 7.798 4.548 9.895-4.829-.705-8.548-4.874-8.548-9.895 0-5.08 3.808-9.288 8.719-9.918zm1.281-2.082c-6.617 0-12 5.383-12 12s5.383 12 12 12c1.894 0 3.87-.333 5.37-1.179-3.453-.613-9.37-3.367-9.37-10.821 0-7.555 6.422-10.317 9.37-10.821-1.74-.682-3.476-1.179-5.37-1.179zm0 10.999c1.437.438 2.562 1.564 2.999 3.001.44-1.437 1.565-2.562 3.001-3-1.436-.439-2.561-1.563-3.001-3-.437 1.436-1.562 2.561-2.999 2.999zm8.001.001c.958.293 1.707 1.042 2 2.001.291-.959 1.042-1.709 1.999-2.001-.957-.292-1.707-1.042-2-2-.293.958-1.042 1.708-1.999 2zm-1-9c-.437 1.437-1.563 2.562-2.998 3.001 1.438.44 2.561 1.564 3.001 3.002.437-1.438 1.563-2.563 2.996-3.002-1.433-.437-2.559-1.564-2.999-3.001z" /></svg>
                                 <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><path d="M4.069 13h-4.069v-2h4.069c-.041.328-.069.661-.069 1s.028.672.069 1zm3.034-7.312l-2.881-2.881-1.414 1.414 2.881 2.881c.411-.529.885-1.003 1.414-1.414zm11.209 1.414l2.881-2.881-1.414-1.414-2.881 2.881c.528.411 1.002.886 1.414 1.414zm-6.312-3.102c.339 0 .672.028 1 .069v-4.069h-2v4.069c.328-.041.661-.069 1-.069zm0 16c-.339 0-.672-.028-1-.069v4.069h2v-4.069c-.328.041-.661.069-1 .069zm7.931-9c.041.328.069.661.069 1s-.028.672-.069 1h4.069v-2h-4.069zm-3.033 7.312l2.88 2.88 1.415-1.414-2.88-2.88c-.412.528-.886 1.002-1.415 1.414zm-11.21-1.415l-2.88 2.88 1.414 1.414 2.88-2.88c-.528-.411-1.003-.885-1.414-1.414zm2.312-4.897c0 2.206 1.794 4 4 4s4-1.794 4-4-1.794-4-4-4-4 1.794-4 4zm10 0c0 3.314-2.686 6-6 6s-6-2.686-6-6 2.686-6 6-6 6 2.686 6 6z" /></svg>
                              </span>
                           </label>
                           <button onClick={handleLogout} className="header__logout">
                              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 2v20h14v-2h-12v-16h12v-2h-14zm18 7.408l2.963 2.592-2.963 2.592v-1.592h-8v-2h8v-1.592zm-2-4.408v4h-8v6h8v4l8-7-8-7z" /></svg>
                           </button>
                        </div>
                     </div>

                  </div>
               </div>
            </header>
         }
      </>
   )
}

export default Header